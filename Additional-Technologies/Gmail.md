# Threat Hunting with Gmail Overview

This file provides threat hunting hypotheses, detection keywords, suspicious behaviors, and monitoring guidance for Gmail environments (Google Workspace and personal Gmail), focusing on security event investigation and incident response.

## Log Sources
- Google Workspace Admin Audit Logs
- Gmail Log Search (Admin console)
- Google Workspace Alert Center
- OAuth Token Activity logs
- Google Workspace Security Investigation Tool
- IMAP/POP3/SMTP access logs
- User account activity logs

---

## Threat Hunting Log Search Keywords 

| **Keyword / Event**                  | **Description / Threat Scenario**                                           |
|--------------------------------------|----------------------------------------------------------------------------|
| `unauthorized`                       | Unauthorized or suspicious access attempts.                                |
| `failed login`                       | Login attempts that failed; may indicate brute force or credential stuffing.|
| `suspicious login`                   | Logins from unknown devices or locations.                                  |
| `login from new device/location`     | New device or IP, potential account compromise.                            |
| `login challenge`                    | Triggered when Google suspects unusual login; risk of bypass.              |
| `password reset`                     | Could be attacker-initiated or part of account recovery.                   |
| `2-step verification failure`        | Failed attempts at MFA; may signal phishing or hijack attempt.             |
| `OAuth consent`                      | User grants access to third-party app; risk of OAuth phishing.             |
| `delegated access`                   | Another account has access to mailbox; check for abuse.                    |
| `suspicious app`                     | Apps flagged as risky by Google.                                           |
| `API access granted`                 | OAuth or API tokens issued for mailbox access.                             |
| `data export` / `download`           | Large-scale data extraction.                                               |
| `mailbox rules created/modified`     | Changes in forwarding, filters, or rules may hide attacker activity.       |
| `auto-forwarding enabled`            | Outbound data exfiltration vector.                                         |
| `phishing` / `malware` / `spam`      | Detected or reported malicious email.                                      |
| `account disabled`                   | Account disabled, often after compromise or policy violation.              |
| `security alert`                     | Security warnings generated by Google.                                     |

---

## Gmail-Specific Suspicious Operations & Events

- Suspicious sign-in prevented
- Password changed
- Password recovery initiated
- IMAP/POP/SMTP enabled
- Third-party app access granted
- OAuth token granted
- Unusual external email forwarding
- Unusual download activity
- Bulk email deletion
- Label or filter created by user
- Automatic forwarding enabled
- Suspicious app installed
- Account recovery info changed
- Access by less secure apps

---

## High-Risk Behaviors & Use Cases

- Login from new or unexpected locations or devices
- Multiple failed authentication attempts in a short time
- Enabling IMAP/POP access where usually disabled
- New third-party app integrations or OAuth token grants, especially those requesting broad access
- Creation of new mailbox rules, especially auto-forwarding to external domains
- Bulk deletion or export of mailbox content
- Changes to account recovery options (secondary email or phone)
- Access to sensitive email threads from unknown IPs

---

## Advanced Threat Indicators

- OAuth phishing: malicious app requests access to mailbox
- Consent phishing: attacker tricks user into granting app access
- OAuth tokens used for mass download/export of mail
- Lateral phishing: compromised account sending phishing internally
- Malicious mailbox rules to hide incoming phishing or auto-exfiltrate email
- Use of “less secure apps” for bypassing modern authentication controls
- Business Email Compromise (BEC) indicators, such as invoice or wire transfer fraud

---

## Response Recommendations

- Monitor and alert on all suspicious sign-in and OAuth consent events
- Regularly audit mailbox rules, auto-forwarding, and delegated access
- Enforce 2-step verification (2SV) or multi-factor authentication (MFA)
- Restrict IMAP/POP/SMTP and access by less secure apps
- Limit third-party app access through OAuth whitelisting
- Use the Security Investigation Tool for investigations and incident response
- Educate users about consent phishing and suspicious app access requests

---

## References

- [Google Workspace Security Center](https://support.google.com/a/answer/9157861)
- [Gmail Log Search](https://support.google.com/a/answer/7061566)
- [Detecting and Responding to Phishing with Gmail](https://workspaceupdates.googleblog.com/2021/06/gmail-phishing-security.html)
